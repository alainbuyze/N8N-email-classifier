<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Results - Outlook Email Categorizer</title>
    <style>
      body { font-family: Arial, sans-serif; margin: 32px; }
      .container { max-width: 1100px; margin: 0 auto; }
      .top { display:flex; align-items:center; justify-content: space-between; gap: 16px; }
      a { color: #111827; }
      .summary { margin-top: 16px; padding: 12px; border: 1px solid #ddd; border-radius: 8px; }
      table { width: 100%; border-collapse: collapse; margin-top: 16px; }
      th, td { text-align: left; padding: 10px; border-bottom: 1px solid #eee; }
      th { background: #f9fafb; }
      .badge { display:inline-block; padding: 2px 8px; border-radius: 999px; font-size: 0.85rem; }
      .ok { background: #dcfce7; }
      .bad { background: #fee2e2; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="top">
        <h1>Results</h1>
        <a href="/">Run again</a>
      </div>

      <div class="summary">
        <div><strong>Total:</strong> {{ summary.total }}</div>
        <div><strong>Successful:</strong> {{ summary.successful }}</div>
        <div><strong>Failed:</strong> {{ summary.failed }}</div>
        <div style="margin-top: 8px;">
          <span class="mono">limit={{ limit }}</span>
          <span class="mono">folder_label={{ folder_label }}</span>
          <span class="mono">dry_run={{ dry_run }}</span>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th>Status</th>
            <th>Received</th>
            <th>Sender</th>
            <th>Subject</th>
            <th>Category</th>
            <th>Subcategory</th>
            <th>Error</th>
          </tr>
        </thead>
        <tbody>
          {% for r in results %}
          <tr>
            <td>
              {% if r.success %}
                <span class="badge ok">OK</span>
              {% else %}
                <span class="badge bad">FAIL</span>
              {% endif %}
            </td>
            <td>{{ r.received_date_time }}</td>
            <td>{{ r.sender }}</td>
            <td>{{ r.subject }}</td>
            <td>{{ r.category }}</td>
            <td>{{ r.sub_category }}</td>
            <td>{{ r.error }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </body>
</html>
